<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spicyR">
<title>Introduction to SegmentedCells • spicyR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to SegmentedCells">
<meta property="og:description" content="spicyR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spicyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.11.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/spicyR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/segmentedCells.html">Introduction to SegmentedCells</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ellispatrick/spicyR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to SegmentedCells</h1>
                        <h4 data-toc-skip class="author">Nicolas
Canete</h4>
            <address class="author_afil">
      Westmead Institute for Medical Research, University of Sydney,
Australia<br><a class="author_email" href="mailto:#"></a><a href="mailto:nicolas.canete@sydney.edu.au" class="email">nicolas.canete@sydney.edu.au</a>
      </address>
                              <h4 data-toc-skip class="author">Ellis
Patrick</h4>
            <address class="author_afil">
      Westmead Institute for Medical Research, University of Sydney,
AustraliaSchool of Mathematics and Statistics, University of Sydney,
Australia<br><a class="author_email" href="mailto:#"></a><a href="mailto:ellis.patrick@sydney.edu.au" class="email">ellis.patrick@sydney.edu.au</a>
      </address>
                  
            <h4 data-toc-skip class="date">14 November 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ellispatrick/spicyR/blob/HEAD/vignettes/segmentedCells.Rmd" class="external-link"><code>vignettes/segmentedCells.Rmd</code></a></small>
      <div class="d-none name"><code>segmentedCells.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"spicyR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A <code>SegmentedCells</code> is an object designed to store data
from imaging cytometry (FISH, IMC, CycIF, spatial transcriptomics, … )
that has already been segmented and reduced to individual cells. A
<code>SegmentedCells</code> extends DataFrame and defines methods that
take advantage of DataFrame nesting to represent various elements of
cell-based experiments with spatial orientation that are commonly
encountered. This object is able to store information on a cell’s
spatial location, cellType, morphology, intensity of gene/protein marks
as well as image level phenotype information. Ideally this type of data
can be used for cell clustering, point process models or nearest
neighbour analysis. Below we will consider a few examples of data
formats that can be transformed into a <code>SegmentedCells</code>.</p>
<p>First, load the <code>spicyR</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spicyR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/S4Vectors" class="external-link">S4Vectors</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-1---data-resembles-cellprofiler-output">Example 1 - Data resembles cellProfiler output<a class="anchor" aria-label="anchor" href="#example-1---data-resembles-cellprofiler-output"></a>
</h2>
<p>Here we create a <code>SegmentedCells</code> from data that was
output from cellProfiler or similar programs. This assumes that there
are columns with the string <em>AreaShape_</em> and
<em>Intensity_Mean</em> and that there are <code>ObjectNumber</code> and
<code>ImageNumber</code> columns.</p>
<p>Here we create toy cellProfiler data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Something that resembles cellProfiler data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51773</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">ObjectNumber</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">ImageNumber</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span>,<span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">AreaShape_Center_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">AreaShape_Center_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">AreaShape_round</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">AreaShape_diameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">Intensity_Mean_CD8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">Intensity_Mean_CD4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We can then create a <code>SegmentedCells</code> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cellExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SegmentedCells.html">SegmentedCells</a></span><span class="op">(</span><span class="va">cells</span>, cellProfiler <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; There is no cellType column, setting to NA</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="va">cellExp</span></span>
<span><span class="co">#&gt; A SegmentedCells object with...</span></span>
<span><span class="co">#&gt; Number of images:2</span></span>
<span><span class="co">#&gt; Number of cells:10</span></span>
<span><span class="co">#&gt; Number of cell types: 1 [ NA ]</span></span>
<span><span class="co">#&gt; Number of intensities: 2 [ CD8, CD4 ]</span></span>
<span><span class="co">#&gt; Number of morphologies: 2 [ round, diameter ]</span></span>
<span><span class="co">#&gt; Number of image phenotypes: 0 [ ]</span></span></code></pre></div>
<p>Extract the cellSummary information and overwrite it as well.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cellSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellSummary</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cellSum</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 6 columns</span></span>
<span><span class="co">#&gt;    imageID      cellID imageCellID         x         y cellType</span></span>
<span><span class="co">#&gt;   &lt;factor&gt; &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt; 1        1      cell_1      cell_1  0.367243  0.820150       NA</span></span>
<span><span class="co">#&gt; 2        1      cell_2      cell_2  0.613818  0.846200       NA</span></span>
<span><span class="co">#&gt; 3        1      cell_3      cell_3  0.335930  0.318286       NA</span></span>
<span><span class="co">#&gt; 4        1      cell_4      cell_4  0.501737  0.373931       NA</span></span>
<span><span class="co">#&gt; 5        1      cell_5      cell_5  0.829350  0.140415       NA</span></span>
<span><span class="co">#&gt; 6        2      cell_6      cell_6  0.831271  0.175128       NA</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Accessors.html">cellSummary</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cellSum</span></span></code></pre></div>
<p>We can then set the cell types of each cell by extracting and
clustering marker intensity information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellMarks</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="va">kM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">markers</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Accessors.html">cellType</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="va">kM</span><span class="op">$</span><span class="va">cluster</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cellSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellSummary</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cellSum</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 6 columns</span></span>
<span><span class="co">#&gt;    imageID      cellID imageCellID         x         y cellType</span></span>
<span><span class="co">#&gt;   &lt;factor&gt; &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt; 1        1      cell_1      cell_1  0.367243  0.820150 cluster1</span></span>
<span><span class="co">#&gt; 2        1      cell_2      cell_2  0.613818  0.846200 cluster1</span></span>
<span><span class="co">#&gt; 3        1      cell_3      cell_3  0.335930  0.318286 cluster2</span></span>
<span><span class="co">#&gt; 4        1      cell_4      cell_4  0.501737  0.373931 cluster2</span></span>
<span><span class="co">#&gt; 5        1      cell_5      cell_5  0.829350  0.140415 cluster1</span></span>
<span><span class="co">#&gt; 6        2      cell_6      cell_6  0.831271  0.175128 cluster1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2---three-pancreatic-islets-from-from-damond-et-al-2019">Example 2 - Three pancreatic islets from from Damond et al
(2019)<a class="anchor" aria-label="anchor" href="#example-2---three-pancreatic-islets-from-from-damond-et-al-2019"></a>
</h2>
<p>Read in data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">isletFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"isletCells.txt.gz"</span>, package <span class="op">=</span> <span class="st">"spicyR"</span><span class="op">)</span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">isletFile</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We can then create a <code>SegmentedCells</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cellExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SegmentedCells.html">SegmentedCells</a></span><span class="op">(</span><span class="va">cells</span>, cellProfiler <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; There is no cellType column, setting to NA</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="va">cellExp</span></span>
<span><span class="co">#&gt; A SegmentedCells object with...</span></span>
<span><span class="co">#&gt; Number of images:1</span></span>
<span><span class="co">#&gt; Number of cells:4650</span></span>
<span><span class="co">#&gt; Number of cell types: 1 [ NA ]</span></span>
<span><span class="co">#&gt; Number of intensities: 38 [ c1, c10, ..., c9 ]</span></span>
<span><span class="co">#&gt; Number of morphologies: 15 [ Area, Compactness, ..., Solidity ]</span></span>
<span><span class="co">#&gt; Number of image phenotypes: 0 [ ]</span></span></code></pre></div>
<p>We can then set the cell types of each cell by extracting and
clustering marker intensity information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellMarks</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="va">kM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">markers</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Accessors.html">cellType</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="va">kM</span><span class="op">$</span><span class="va">cluster</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cellSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellSummary</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cellSum</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 6 columns</span></span>
<span><span class="co">#&gt;    imageID      cellID imageCellID         x         y cellType</span></span>
<span><span class="co">#&gt;   &lt;factor&gt; &lt;character&gt; &lt;character&gt; &lt;integer&gt; &lt;integer&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt; 1        1      cell_1      cell_1        53         0 cluster1</span></span>
<span><span class="co">#&gt; 2        1      cell_2      cell_2       128         0 cluster1</span></span>
<span><span class="co">#&gt; 3        1      cell_3      cell_3       135         0 cluster1</span></span>
<span><span class="co">#&gt; 4        1      cell_4      cell_4       450         0 cluster1</span></span>
<span><span class="co">#&gt; 5        1      cell_5      cell_5       458         0 cluster3</span></span>
<span><span class="co">#&gt; 6        1      cell_6      cell_6       551         0 cluster3</span></span></code></pre></div>
<p>Here is a very simple plot in ggplot showing the spatial distribution
of the cell types</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot-SegmentedCells.html">plot</a></span><span class="op">(</span><span class="va">cellExp</span>, imageID<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="segmentedCells_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="example-3---custom-markerintensity-and-morphology-column-names">Example 3 - Custom markerintensity and morphology column names<a class="anchor" aria-label="anchor" href="#example-3---custom-markerintensity-and-morphology-column-names"></a>
</h2>
<p>Here we create toy data that has a slightly more fluid naming
stucture.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51773</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">cellID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">imageCellID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">imageID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span>,<span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">shape_round</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">shape_diameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">intensity_CD8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">intensity_CD4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">cellType</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">n</span>,replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span></code></pre></div>
<p>We can then create a <code>SegmentedCells</code> object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cellExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SegmentedCells.html">SegmentedCells</a></span><span class="op">(</span><span class="va">cells</span>, </span>
<span>                          cellTypeString <span class="op">=</span> <span class="st">'cellType'</span>, </span>
<span>                          intensityString <span class="op">=</span> <span class="st">'intensity_'</span>, </span>
<span>                          morphologyString <span class="op">=</span> <span class="st">'shape_'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The dim() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   dims() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The nrow() method for DataFrameList objects is deprecated. Please use</span></span>
<span><span class="co">#&gt;   nrows() on these objects instead.</span></span>
<span><span class="co">#&gt; Warning: The ncol() method for CompressedSplitDataFrameList objects is</span></span>
<span><span class="co">#&gt;   deprecated. Please use ncols() on these objects instead.</span></span>
<span><span class="va">cellExp</span></span>
<span><span class="co">#&gt; A SegmentedCells object with...</span></span>
<span><span class="co">#&gt; Number of images:2</span></span>
<span><span class="co">#&gt; Number of cells:10</span></span>
<span><span class="co">#&gt; Number of cell types: 2 [ cluster_1, cluster_2 ]</span></span>
<span><span class="co">#&gt; Number of intensities: 2 [ CD8, CD4 ]</span></span>
<span><span class="co">#&gt; Number of morphologies: 2 [ round, diameter ]</span></span>
<span><span class="co">#&gt; Number of image phenotypes: 0 [ ]</span></span></code></pre></div>
<p>Extract morphology information</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">morph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellMorph</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">morph</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 2 columns</span></span>
<span><span class="co">#&gt;       round  diameter</span></span>
<span><span class="co">#&gt;   &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; 1  0.489959 1.3913000</span></span>
<span><span class="co">#&gt; 2  3.601540 0.3670445</span></span>
<span><span class="co">#&gt; 3  0.243015 0.0149731</span></span>
<span><span class="co">#&gt; 4  0.077238 1.1434083</span></span>
<span><span class="co">#&gt; 5  0.639661 0.0043457</span></span>
<span><span class="co">#&gt; 6  0.498723 0.0341195</span></span></code></pre></div>
<div class="section level3">
<h3 id="phenotype-information">Phenotype information<a class="anchor" aria-label="anchor" href="#phenotype-information"></a>
</h3>
<p>We can also include phenotype information for each image. Create some
corresponding toy phenotype information which must have a
<code>imageID</code> variable.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenoData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>imageID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'2'</span><span class="op">)</span>, </span>
<span>                       age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">81</span><span class="op">)</span>, </span>
<span>                       status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dead'</span>,<span class="st">'alive'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Accessors.html">imagePheno</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">phenoData</span></span>
<span><span class="fu"><a href="../reference/Accessors.html">imagePheno</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 2 rows and 3 columns</span></span>
<span><span class="co">#&gt;       imageID       age      status</span></span>
<span><span class="co">#&gt;   &lt;character&gt; &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span>
<span><span class="fu"><a href="../reference/Accessors.html">imagePheno</a></span><span class="op">(</span><span class="va">cellExp</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 10 rows and 3 columns</span></span>
<span><span class="co">#&gt;       imageID       age      status</span></span>
<span><span class="co">#&gt;   &lt;character&gt; &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 1           1        21        dead</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span>
<span><span class="co">#&gt; 2           2        81       alive</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-4---minimal-example-cells-only-have-spatial-coordinates">Example 4 - Minimal example, cells only have spatial
coordinates<a class="anchor" aria-label="anchor" href="#example-4---minimal-example-cells-only-have-spatial-coordinates"></a>
</h2>
<p>Here we generate data where we only know the location of each
cell.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51773</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cells</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">cellExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SegmentedCells.html">SegmentedCells</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span></span>
<span><span class="co">#&gt; There is no cellType column, setting to NA</span></span>
<span><span class="co">#&gt; There is no cellID. I'll create these</span></span>
<span><span class="co">#&gt; There is no image specific imageCellID. I'll create these</span></span>
<span><span class="co">#&gt; There is no imageID. I'll assume this is only one image and create an arbitrary imageID</span></span>
<span><span class="va">cellExp</span></span>
<span><span class="co">#&gt; A SegmentedCells object with...</span></span>
<span><span class="co">#&gt; Number of images:1</span></span>
<span><span class="co">#&gt; Number of cells:10</span></span>
<span><span class="co">#&gt; Number of cell types: 1 [ NA ]</span></span>
<span><span class="co">#&gt; Number of intensities: 0 [ ]</span></span>
<span><span class="co">#&gt; Number of morphologies: 0 [ ]</span></span>
<span><span class="co">#&gt; Number of image phenotypes: 0 [ ]</span></span></code></pre></div>
<p>Extract the cellSummary information which now also has cellIDs and
imageIDs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cellSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Accessors.html">cellSummary</a></span><span class="op">(</span><span class="va">cellExp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cellSum</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 6 rows and 6 columns</span></span>
<span><span class="co">#&gt;    imageID      cellID imageCellID         x         y cellType</span></span>
<span><span class="co">#&gt;   &lt;factor&gt; &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt; 1   image1      cell_1      cell_1  0.367243  0.820150       NA</span></span>
<span><span class="co">#&gt; 2   image1      cell_2      cell_2  0.613818  0.846200       NA</span></span>
<span><span class="co">#&gt; 3   image1      cell_3      cell_3  0.335930  0.318286       NA</span></span>
<span><span class="co">#&gt; 4   image1      cell_4      cell_4  0.501737  0.373931       NA</span></span>
<span><span class="co">#&gt; 5   image1      cell_5      cell_5  0.829350  0.140415       NA</span></span>
<span><span class="co">#&gt; 6   image1      cell_6      cell_6  0.831271  0.175128       NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo()<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: EndeavourOS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/libblas.so.3.11.0</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/liblapack.so.3.11.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] S4Vectors_0.36.0    BiocGenerics_0.44.0 spicyR_1.11.1      </span></span>
<span><span class="co">#&gt; [4] BiocStyle_2.26.0   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] SpatialExperiment_1.8.0     minqa_1.2.5                </span></span>
<span><span class="co">#&gt;   [3] colorspace_2.0-3            deldir_1.0-6               </span></span>
<span><span class="co">#&gt;   [5] rjson_0.2.21                rprojroot_2.0.3            </span></span>
<span><span class="co">#&gt;   [7] scuttle_1.8.0               XVector_0.38.0             </span></span>
<span><span class="co">#&gt;   [9] GenomicRanges_1.50.1        fs_1.5.2                   </span></span>
<span><span class="co">#&gt;  [11] spatstat.data_3.0-0         farver_2.1.1               </span></span>
<span><span class="co">#&gt;  [13] fansi_1.0.3                 codetools_0.2-18           </span></span>
<span><span class="co">#&gt;  [15] splines_4.2.2               R.methodsS3_1.8.2          </span></span>
<span><span class="co">#&gt;  [17] sparseMatrixStats_1.10.0    cachem_1.0.6               </span></span>
<span><span class="co">#&gt;  [19] knitr_1.40                  polyclip_1.10-4            </span></span>
<span><span class="co">#&gt;  [21] jsonlite_1.8.3              nloptr_2.0.3               </span></span>
<span><span class="co">#&gt;  [23] R.oo_1.25.0                 pheatmap_1.0.12            </span></span>
<span><span class="co">#&gt;  [25] spatstat.sparse_3.0-0       ggforce_0.4.1              </span></span>
<span><span class="co">#&gt;  [27] HDF5Array_1.26.0            BiocManager_1.30.19        </span></span>
<span><span class="co">#&gt;  [29] compiler_4.2.2              dqrng_0.3.0                </span></span>
<span><span class="co">#&gt;  [31] assertthat_0.2.1            Matrix_1.5-3               </span></span>
<span><span class="co">#&gt;  [33] fastmap_1.1.0               limma_3.54.0               </span></span>
<span><span class="co">#&gt;  [35] cli_3.4.1                   tweenr_2.0.2               </span></span>
<span><span class="co">#&gt;  [37] htmltools_0.5.3             tools_4.2.2                </span></span>
<span><span class="co">#&gt;  [39] lmerTest_3.1-3              gtable_0.3.1               </span></span>
<span><span class="co">#&gt;  [41] glue_1.6.2                  GenomeInfoDbData_1.2.9     </span></span>
<span><span class="co">#&gt;  [43] dplyr_1.0.10                Rcpp_1.0.9                 </span></span>
<span><span class="co">#&gt;  [45] Biobase_2.58.0              jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt;  [47] pkgdown_2.0.6               vctrs_0.5.0                </span></span>
<span><span class="co">#&gt;  [49] rhdf5filters_1.10.0         spatstat.explore_3.0-5     </span></span>
<span><span class="co">#&gt;  [51] nlme_3.1-160                DelayedMatrixStats_1.20.0  </span></span>
<span><span class="co">#&gt;  [53] spatstat.random_3.0-1       xfun_0.34                  </span></span>
<span><span class="co">#&gt;  [55] stringr_1.4.1               beachmat_2.14.0            </span></span>
<span><span class="co">#&gt;  [57] lme4_1.1-31                 lifecycle_1.0.3            </span></span>
<span><span class="co">#&gt;  [59] goftest_1.2-3               scam_1.2-13                </span></span>
<span><span class="co">#&gt;  [61] edgeR_3.40.0                zlibbioc_1.44.0            </span></span>
<span><span class="co">#&gt;  [63] MASS_7.3-58.1               scales_1.2.1               </span></span>
<span><span class="co">#&gt;  [65] ragg_1.2.4                  MatrixGenerics_1.10.0      </span></span>
<span><span class="co">#&gt;  [67] spatstat.utils_3.0-1        parallel_4.2.2             </span></span>
<span><span class="co">#&gt;  [69] SummarizedExperiment_1.28.0 rhdf5_2.42.0               </span></span>
<span><span class="co">#&gt;  [71] RColorBrewer_1.1-3          SingleCellExperiment_1.20.0</span></span>
<span><span class="co">#&gt;  [73] yaml_2.3.6                  memoise_2.0.1              </span></span>
<span><span class="co">#&gt;  [75] ggplot2_3.4.0               sass_0.4.2                 </span></span>
<span><span class="co">#&gt;  [77] stringi_1.7.8               highr_0.9                  </span></span>
<span><span class="co">#&gt;  [79] desc_1.4.2                  boot_1.3-28                </span></span>
<span><span class="co">#&gt;  [81] BiocParallel_1.32.1         GenomeInfoDb_1.34.2        </span></span>
<span><span class="co">#&gt;  [83] rlang_1.0.6                 pkgconfig_2.0.3            </span></span>
<span><span class="co">#&gt;  [85] systemfonts_1.0.4           matrixStats_0.62.0         </span></span>
<span><span class="co">#&gt;  [87] bitops_1.0-7                evaluate_0.18              </span></span>
<span><span class="co">#&gt;  [89] lattice_0.20-45             tensor_1.5                 </span></span>
<span><span class="co">#&gt;  [91] purrr_0.3.5                 Rhdf5lib_1.20.0            </span></span>
<span><span class="co">#&gt;  [93] labeling_0.4.2              tidyselect_1.2.0           </span></span>
<span><span class="co">#&gt;  [95] magrittr_2.0.3              bookdown_0.30              </span></span>
<span><span class="co">#&gt;  [97] R6_2.5.1                    IRanges_2.32.0             </span></span>
<span><span class="co">#&gt;  [99] magick_2.7.3                generics_0.1.3             </span></span>
<span><span class="co">#&gt; [101] DelayedArray_0.24.0         DBI_1.1.3                  </span></span>
<span><span class="co">#&gt; [103] pillar_1.8.1                withr_2.5.0                </span></span>
<span><span class="co">#&gt; [105] mgcv_1.8-41                 abind_1.4-5                </span></span>
<span><span class="co">#&gt; [107] RCurl_1.98-1.9              tibble_3.1.8               </span></span>
<span><span class="co">#&gt; [109] DropletUtils_1.18.0         utf8_1.2.2                 </span></span>
<span><span class="co">#&gt; [111] spatstat.geom_3.0-3         rmarkdown_2.18             </span></span>
<span><span class="co">#&gt; [113] locfit_1.5-9.6              grid_4.2.2                 </span></span>
<span><span class="co">#&gt; [115] data.table_1.14.4           digest_0.6.30              </span></span>
<span><span class="co">#&gt; [117] tidyr_1.2.1                 numDeriv_2016.8-1.1        </span></span>
<span><span class="co">#&gt; [119] R.utils_2.12.2              textshaping_0.3.6          </span></span>
<span><span class="co">#&gt; [121] munsell_0.5.0               concaveman_1.1.0           </span></span>
<span><span class="co">#&gt; [123] bslib_0.4.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicolas Canete, Ellis Patrick.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
