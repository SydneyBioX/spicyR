% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllClasses.R, R/spicy.R
\docType{class}
\name{SpicyResults-class}
\alias{SpicyResults-class}
\alias{SpicyResults,list,ANY-method}
\alias{spicy}
\alias{spicy,spicy-method}
\title{Performs spatial tests on spatial cytometry data.}
\usage{
spicy(
  cells,
  condition,
  subject = NULL,
  covariates = NULL,
  from = NULL,
  to = NULL,
  imageIDCol = "imageID",
  cellTypeCol = "cellType",
  spatialCoordCols = c("x", "y"),
  alternateResult = NULL,
  verbose = FALSE,
  weights = TRUE,
  weightsByPair = FALSE,
  weightFactor = 1,
  window = "convex",
  window.length = NULL,
  BPPARAM = BiocParallel::SerialParam(),
  sigma = NULL,
  Rs = NULL,
  minLambda = 0.05,
  edgeCorrect = TRUE,
  includeZeroCells = FALSE,
  ...
)
}
\arguments{
\item{cells}{A SummarizedExperiment or data frame that contains at least the  variables
x and y, giving the location coordinates of each cell, and cellType.}

\item{condition}{Vector of conditions to be tested corresponding to each image.}

\item{subject}{Vector of subject IDs corresponding to each image if cells is
a data frame.}

\item{covariates}{Vector of covariate names that should be included in the
mixed effects model as fixed effects.}

\item{from}{vector of cell types which you would like to compare to the to vector}

\item{to}{vector of cell types which you would like to compare to the from vector}

\item{imageIDCol}{The image ID if using SingleCellExperiment.}

\item{cellTypeCol}{The cell type if using SingleCellExperiment.}

\item{spatialCoordCols}{The spatial coordinates if using a SingleCellExperiment.}

\item{alternateResult}{An pairwise association statistic between each combination of celltypes in
each image.}

\item{verbose}{logical indicating whether to output messages.}

\item{weights}{logical indicating whether to include weights based on cell counts.}

\item{weightsByPair}{logical indicating whether weights should be calculated for each cell type
pair.}

\item{weightFactor}{numeric that controls the convexity of the weight function.}

\item{window}{Should the window around the regions be 'square', 'convex' or 'concave'.}

\item{window.length}{A tuning parameter for controlling the level of concavity when estimating
concave windows.}

\item{BPPARAM}{A BiocParallelParam object.}

\item{sigma}{A numeric variable used for scaling when fitting inhomogeneous L-curves.}

\item{Rs}{A vector of radii that the measures of association should be calculated. If
NULL, Rs = c(20, 50, 100) is specified by default.}

\item{minLambda}{Minimum value for density for scaling when fitting inhomogeneous L-curves.}

\item{edgeCorrect}{A logical indicating whether to perform edge correction.}

\item{includeZeroCells}{A logical indicating whether to include cells with zero counts in the
pairwise association calculation.}

\item{...}{Other options.}
}
\value{
Data frame of p-values.
}
\description{
Performs spatial tests on spatial cytometry data.
}
\examples{
data("diabetesData")

# Test with random effect for patient on a pairwise combination of cell
# types.
spicy(diabetesData,
  condition = "stage", subject = "case",
  from = "Tc", to = "Th"
)

# Test all pairwise combinations of cell types without random effect of
# patient.
\dontrun{
spicyTest <- spicy(diabetesData, condition = "stage", subject = "case")
}

# Test all pairwise combination of cell types with random effect of patient.
\dontrun{
spicy(diabetesData, condition = "condition", subject = "subject")
}

}
